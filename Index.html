<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Microserviço AWS - Cálculo de Imposto</title>
</head>
<body style="font-family: Arial, sans-serif; background: #8397ac; display: flex; justify-content: center; align-items: center; height: 100vh;">
<div style="background: white; padding: 30px; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.1); width: 350px;">
<h2 style="text-align:center; color:#155786;"> Cálculo de Imposto</h2>
<label for="valor" style="font-weight:bold;">Digite o valor:</label>
<input type="number" id="valor" placeholder="Ex: 100"
          style="width:100%; padding:10px; margin-top:8px; border:1px solid #777474; border-radius:6px;">
<p style="font-weight:bold; margin-top:15px;">Escolha o regime tributário:</p>
<div style="margin-top:8px; margin-bottom:10px;">
<label><input type="radio" name="regime" value="simples" checked> Simples Nacional (6%)</label><br>
<label><input type="radio" name="regime" value="presumido"> Lucro Presumido (12%)</label><br>
<label><input type="radio" name="regime" value="real"> Lucro Real (15%)</label>
</div>
<button onclick="calcularImposto()" style="
     margin-top:15px;
     background:#28a745;
     color:white;
     padding:10px 15px;
     border:none;
     border-radius:6px;
     cursor:pointer;
     width:100%;
     font-weight:bold;
   ">Calcular</button>
<pre id="resultado" style="
     background:#e9ecef;
     border-radius:6px;
     padding:10px;
     margin-top:20px;
     color:#333;
     font-size:14px;
     white-space: pre-wrap;
   ">O resultado aparecerá aqui...</pre>
</div>
<script>
   async function calcularImposto() {
     const valor = document.getElementById("valor").value;
     const regime = document.querySelector('input[name="regime"]:checked').value;
     if (!valor) {
       alert("Por favor, insira um valor!");
       return;
     }
     try {
       const resposta = await fetch("https://COLE_SEU_ENDPOINT_AQUI.amazonaws.com/default/calculoImposto", {
         method: "POST",
         headers: {
           "Content-Type": "application/json"
         },
         body: JSON.stringify({ valor: parseFloat(valor), regime: regime })
       });
       if (!resposta.ok) {
         throw new Error("Erro ao acessar o servidor: " + resposta.status);
       }
       const dados = await resposta.json();
       // Verifica se os campos esperados estão no retorno
       if (!dados.valor_original) {
         document.getElementById("resultado").innerText = "❌ Erro: retorno inválido da API.";
         return;
       }
       document.getElementById("resultado").innerText =
         `Regime: ${dados.regime.charAt(0).toUpperCase() + dados.regime.slice(1)}\n` +
         `Valor Original: R$ ${dados.valor_original.toFixed(2)}\n` +
         `Imposto (${(dados.taxa*100).toFixed(0)}%): R$ ${dados.imposto.toFixed(2)}\n` +
         `Total com Imposto: R$ ${dados.total_com_imposto.toFixed(2)}`;
     } catch (erro) {
       document.getElementById("resultado").innerText = "❌ Erro ao calcular imposto.\n" + erro.message;
       console.error(erro);
     }
   }
</script>
</body>
</html>